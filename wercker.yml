box: debian:testing

build:
    steps:
        - arjen/hugo-build:
          version: "0.17"
          disable_pygments: true
deploy:
    box: google/cloud-sdk
    steps:
        - script:
            name: Sync with GCS
            code: |
                echo "[Credentials]" > .boto
                echo "gs_access_key_id = $GCS_ACCESS_KEY_ID" >> .boto
                echo "gs_secret_access_key = $GCS_SECRET_ACCESS_KEY" >> .boto
                echo "[GSUtil]" >> .boto
                echo "default_project_id = $GOOGLE_PROJECT_ID" >> .boto
                export BOTO_PATH=$PWD/.boto
                gsutil -m rsync -r -d public gs://cdiener.com
                gsutil -m cp -r -z html,css,js,xml,txt,json,map,svg public/* gs://cdiener.com
